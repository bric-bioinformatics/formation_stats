---
title: "Practical stats"
format: 
  html: 
    code-fold: true
    embed-resources: true 
editor: visual
---

```{=html}
<style>
details > summary {
  padding: 4px;
  width: 400px;
  background-color: #eeeeee;
  border: none;
  box-shadow: 1px 1px 2px #bbbbbb;
  cursor: pointer;
}

details > p {
  background-color: #E0F8EC;
  padding: 4px;
  margin: 0;
  box-shadow: 1px 1px 2px #bbbbbb;
}
header h1 {
      font-size: 70px;
      font-weight: 600;
      font-palette: tomato;
    }
</style>
```

```{r, setup, echo=F, warning=FALSE,message=FALSE}
require("knitr")
library(readr)
library(tidyverse)
clinical_data <- read_csv("Datasets/clinical_data.csv")
```

# Objectives

The purpose of this section is to provide you with the basics needed to analyze biological data using simple statistics. The main objective is to provide you with the tools to :

-   Choose a statistical method appropriate for a biological question
-   Interpret the results correctly
-   Analyse data with R

# Discover and explore data : `clinical_data`

## Load the data

First step to do is to load our dataset called `clinical_data` in our R environment.
You can follow the instruction below.

![](./Images/load_data.svg){fig-align="center"}

## Description of the data

The first thing to do before starting the analysis is to observe the dataset in order to define the structure and type of data. You can do it by hand, or you can use R and some functions already built in, without installing any packages.

### `head`

The first function you can use is `head`. It will returns the **first** (or **last** with `tail`) **rows** of your dataset. By default, **the 6 first (or last) rows** will be returned.

```{r head}
#| code-fold: false
head(clinical_data)
```

### `str`

The function `str` allows to display the **internal structure** of the data. Using this method, we can see the **dimensions** of our dataset, i.e., the number of rows and columns. Here we have **150 rows and 10 columns**.
You can also see what **type** each column is, like **numerical** or **character**. 

Thanks to this view, we can define more precisely what **type of data** we are dealing with. ([See the descriptive statistics part](./descriptive_stats.html))

```{r str}
#| code-fold: false
str(clinical_data)
```

### `summary`

The `summary` function is very useful because it provides **descriptive statistical results**, as seen in the previous section. For each column, we will find the **median**, the **mean**, and the **quartiles**, among other things.

```{r summary}
#| code-fold: false
summary(clinical_data)
```

# Study 1 : *Do patients with heart disease have a higher heart rate ?*

## First visualisation

We can start by making a simple observation using a **boxplot** of **heart rate** based on patient **diagnosis** :

```{r, echo=F}
ggplot(data = clinical_data, aes(x=diagnosis, y = heart_rate)) +
  geom_boxplot() + 
  labs(x="Diagnosis", y = "Heart rate") +
  theme_bw()
```

Based on this initial visualization, we can see that there appears to be a **difference in heart rate among patients with heart disease**.

## Hypotheses : decision support

A statistical approach is based on reasoning with **two initial solutions** called working **hypotheses**. We find the **null hypothesis** (H0) and the **alternative hypothesis** (H1). 

-   *Null hypothesis* (H0) : corresponds to the **initial assumption**; this hypothesis seeks to confirm that there are **no differences**, for example.
-   *Alternative hypothesis* (H1) : is the opposite, it suggests that **there is a difference or an effect**.

*In our case, what would be the hypotheses ?*

<details>

<summary>Working hypotheses about our question</summary>

H0 = **The average heart rate is not different or lower in patients with heart disease than in other patients**.

H1 = **The average heart rate is higher in patients with heart disease**.

</details>

In our question, and therefore in our assumptions, there is the notion of **â€œhigher".** The biological question is therefore **directional**. So we will be in a situation where we will be on a **one-tailed test**.

## Independent or paired ?

This is an important point when doing **statistics**. It is important to know whether our data is **independent** or **paired**.

-   *Independent* : The choice of elements in the first sample has no influence on the choice of elements in the second sample.

-   *Paired* : The choice of elements in the first sample influences the choice of elements in the second sample.

*What would it be in our case ?*

<details>

<summary>Independent or paired data ?</summary>

All patients in our dataset are **different** from each other and were not selected based on others, so we can say that our samples are **independent**. 

</details>

## Test the parameters

There are many statistical tests available, and it is easy to get confused. Depending on the **biological question** being asked and also on the **data itself**, one test will be used rather than another.

Based on our question, we will seek to **compare groups**, in this case one diagnostic group (**heart disease**) versus the **other diagnostic groups**.

The ultimate goal is to compare the heart rate of patients with heart disease with that of other patients.

## Application of the statistical test

## Interpretation of the results

# Study 2 : une analyse multi-groupes pour anova / krukall
